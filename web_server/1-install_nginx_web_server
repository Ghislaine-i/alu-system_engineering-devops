#!/usr/bin/env bash
# Bash script to install and configure Nginx web server

# Update package list and install nginx with -y flag
apt-get update -y
apt-get install nginx -y

# Create the custom HTML page with EXACT required content
echo "Holberton School for the win!" > /var/www/html/index.html

# Ensure the default nginx site is enabled
cp /etc/nginx/sites-available/default /etc/nginx/sites-available/default.backup

# Configure nginx to serve our custom content
cat > /etc/nginx/sites-available/default << 'EOF'
server {
    listen 80 default_server;
    listen [::]:80 default_server;
    
    root /var/www/html;
    index index.html index.htm;
    
    server_name _;
    
    location / {
        try_files $uri $uri/ =404;
    }
}
EOF

# Test nginx configuration
nginx -t

# Start nginx service (without systemctl)
service nginx stop
service nginx start

# Verify nginx is running and listening on port 80
netstat -tulpn | grep :80

echo "Nginx installation complete. Test with: curl localhost"
